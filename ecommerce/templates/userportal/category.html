{% extends "userportal/base.html" %}
{% block container %}
 {% load static %} 
	<!-- Start Banner Area -->
	<section class="banner-area organic-breadcrumb">
		<div class="container">
			<div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
				<div class="col-first">
					<h1>Shop Category page</h1>
					<nav class="d-flex align-items-center">
						<a href="index.html">Home<span class="lnr lnr-arrow-right"></span></a>
						<a href="#">Shop<span class="lnr lnr-arrow-right"></span></a>
						<a href="category.html">Fashon Category</a>
					</nav>
				</div>
			</div>
		</div>
	</section>
	<!-- End Banner Area -->
	<div class="container">
		<div class="row">
			<div class="col-xl-3 col-lg-4 col-md-5">
				<div class="sidebar-categories">
					
					<div class="head">Browse Categories</div>
					<ul class="main-categories">
						{% for main_category in categories %}
						{% if main_category.parent is None %}			
						<li class="main-nav-list"><a class="border-bottom-0" data-toggle="collapse" href="#babyCare" aria-expanded="false"
							 aria-controls="babyCare"><span class="lnr lnr-arrow-right"></span>{{main_category.name}}<span class="number"></span></a>
							<ul class="collapse" id="babyCare" data-toggle="collapse" aria-expanded="false" aria-controls="babyCare">
								{% for children_category in main_category.children.all %}
								<li class="main-nav-list child" ><a href="#" class="category"  data-category-slug="{{children_category.slug}}">
									{{children_category.name}} 									
									<span class="number">({{children_category.sub_category_count}})</span></a></li>
									{% endfor %}
									
								</ul>
						</li>
						{% endif %}
						{% endfor %}
					</ul>
				</div>

				<div class="sidebar-filter mt-50">
					<div class="top-filter-head">Product Filters</div>
					<div class="common-filter">
						<div class="head">Brands</div>
					
							<ul>
								 {% for brand in brands %}
								<li class="filter-list">
								  <a href="#" class="brand"  data-brand-slug={{brand.slug}} id="{{brand.name}}" name="brand"><label for="{{brand.name}}">
									  {{brand.name}}<span>({{brand.brand_count}})</span>
									</label></a></li>
								{% endfor %}
							 
							</ul>
					
					</div>
					
					<div class="common-filter">
						<div class="head">Price</div>
						<div class="price-range-area">
							<div id="price-range"></div>
							<div class="value-wrapper d-flex">
								<div class="price">Price:</div>
								<span>RS:</span>
								<div id="lower-value"></div>
								<div class="to">to</div>
								<span>RS</span>
								<div id="upper-value"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-xl-9 col-lg-8 col-md-7">
				<!-- Start Filter Bar -->
			
				<div class="filter-bar d-flex flex-wrap align-items-center">
					<div class="sorting">
						
					</div>
					<div class="sorting mr-auto">
						
					</div>
					<div>
						<input type="search" id="mySearch" name="q">
						<button class="btn btn-primary search">Search</button>
					  </div>
					<div class="pagination">
						
						{% if page_obj.has_previous %}
							<a href="#" class="pages" data-page-number={{page_obj.previous_page_number}}><i class="fa fa-long-arrow-left" aria-hidden="true"></i></a>
        				{% endif %}

						{% for page in page_obj.paginator.page_range %}
								<a href="#" class="pages {%if page == page_obj.number %}active{% endif %}" data-page-number={{page}}><span class="current">{{ page }}</span></a>
						{% endfor %}
						
						{% if page_obj.has_next %}
							<a href="#" class="pages" data-page-number={{page_obj.next_page_number}}><i class="fa fa-long-arrow-right" aria-hidden="true"></i></a>
						{% endif %}
						
					</div>
				</div> 
				<!-- End Filter Bar -->
				<!-- Start Best Seller -->
				<section class="lattest-product-area pb-40 category-list">
					<div class="row">
						<!-- single product -->
						{% if not products %}
					<h1>Not found</h1>
						{% endif %}
						{% for product in products %}
						
						<div class="col-lg-4 col-md-6">
							<div class="single-product">
								<a href="{% url 'product:product_details' product.id %}" ><img class="img-fluid" src="{{product.images.all.first}}" alt=""></a>
								<div class="product-details">
									<h6>{{product.name}}</h6>
									<div class="price">
										<h6>${{product.price}}</h6>
										
									</div>
									<div class="prd-bottom">

										<a href="" class="social-info addtocart" data-productid="{{product.id}}">
											<span class="ti-bag"></span>
											<p class="hover-text">add to bag</p>
										</a>
										<a href="" class="social-info">
											<span class="lnr lnr-heart"></span>
											<p class="hover-text">Wishlist</p>
										</a>
										<a href="" class="social-info">
											<span class="lnr lnr-sync"></span>
											<p class="hover-text">compare</p>
										</a>
										<a href="" class="social-info">
											<span class="lnr lnr-move"></span>
											<p class="hover-text">view more</p>
										</a>
									</div>
								</div>
							</div>
						</div>
						{% endfor %}
					
					</div>
				</section>
				<!-- End Best Seller -->
				<!-- Start Filter Bar -->
				<div class="filter-bar d-flex flex-wrap align-items-center">
					<div class="sorting mr-auto">
						<!-- <select>
							<option value="1">Show 12</option>
							<option value="1">Show 12</option>
							<option value="1">Show 12</option>
						</select> -->
					</div>
					
					<div class="pagination">
						
						{% if page_obj.has_previous %}
							<a href="#" class="pages" data-page-number={{page_obj.previous_page_number}}><i class="fa fa-long-arrow-left" aria-hidden="true"></i></a>
        				{% endif %}

						{% for page in page_obj.paginator.page_range %}
								<a href="#" class="pages {%if page == page_obj.number %}active{% endif %}" data-page-number={{page}}><span class="current">{{ page }}</span></a>
						{% endfor %}
						
						{% if page_obj.has_next %}
							<a href="#" class="pages" data-page-number={{page_obj.next_page_number}}><i class="fa fa-long-arrow-right" aria-hidden="true"></i></a>
						{% endif %}

					</div>
				</div>
				<!-- End Filter Bar -->
			</div>
		</div>
	</div>

	<!-- Start related-product Area -->
	<!-- <section class="related-product-area section_gap">
		<div class="container">
			<div class="row justify-content-center">
				<div class="col-lg-6 text-center">
					<div class="section-title">
						<h1>Deals of the Week</h1>
						<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore
							magna aliqua.</p>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-9">
					<div class="row">
						<div class="col-lg-4 col-md-4 col-sm-6 mb-20">
							<div class="single-related-product d-flex">
								<a href="#"><img src="img/r1.jpg" alt=""></a>
								<div class="desc">
									<a href="#" class="title">Black lace Heels</a>
									<div class="price">
										<h6>$189.00</h6>
										<h6 class="l-through">$210.00</h6>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-6 mb-20">
							<div class="single-related-product d-flex">
								<a href="#"><img src="img/r2.jpg" alt=""></a>
								<div class="desc">
									<a href="#" class="title">Black lace Heels</a>
									<div class="price">
										<h6>$189.00</h6>
										<h6 class="l-through">$210.00</h6>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-6 mb-20">
							<div class="single-related-product d-flex">
								<a href="#"><img src="img/r3.jpg" alt=""></a>
								<div class="desc">
									<a href="#" class="title">Black lace Heels</a>
									<div class="price">
										<h6>$189.00</h6>
										<h6 class="l-through">$210.00</h6>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-6 mb-20">
							<div class="single-related-product d-flex">
								<a href="#"><img src="img/r5.jpg" alt=""></a>
								<div class="desc">
									<a href="#" class="title">Black lace Heels</a>
									<div class="price">
										<h6>$189.00</h6>
										<h6 class="l-through">$210.00</h6>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-6 mb-20">
							<div class="single-related-product d-flex">
								<a href="#"><img src="img/r6.jpg" alt=""></a>
								<div class="desc">
									<a href="#" class="title">Black lace Heels</a>
									<div class="price">
										<h6>$189.00</h6>
										<h6 class="l-through">$210.00</h6>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-6 mb-20">
							<div class="single-related-product d-flex">
								<a href="#"><img src="img/r7.jpg" alt=""></a>
								<div class="desc">
									<a href="#" class="title">Black lace Heels</a>
									<div class="price">
										<h6>$189.00</h6>
										<h6 class="l-through">$210.00</h6>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-6">
							<div class="single-related-product d-flex">
								<a href="#"><img src="img/r9.jpg" alt=""></a>
								<div class="desc">
									<a href="#" class="title">Black lace Heels</a>
									<div class="price">
										<h6>$189.00</h6>
										<h6 class="l-through">$210.00</h6>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-6">
							<div class="single-related-product d-flex">
								<a href="#"><img src="img/r10.jpg" alt=""></a>
								<div class="desc">
									<a href="#" class="title">Black lace Heels</a>
									<div class="price">
										<h6>$189.00</h6>
										<h6 class="l-through">$210.00</h6>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-6">
							<div class="single-related-product d-flex">
								<a href="#"><img src="img/r11.jpg" alt=""></a>
								<div class="desc">
									<a href="#" class="title">Black lace Heels</a>
									<div class="price">
										<h6>$189.00</h6>
										<h6 class="l-through">$210.00</h6>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-3">
					<div class="ctg-right">
						<a href="#" target="_blank">
							<img class="img-fluid d-block mx-auto" src="img/category/c5.jpg" alt="">
						</a>
					</div>
				</div>
			</div>
		</div>
	</section> -->
	<!-- End related-product Area -->

{% endblock %} {% block javascript %}


<script type="text/javascript">
	$(document).ready(function(){
        var url = new URL(window.location);
        category = url.searchParams.get('category')
        console.log(category)
        brand_list = url.searchParams.getAll('brand')
		console.log("brand_list",brand_list)
		pages = url.searchParams.get('page')

		$('.category').click(function(){
            updated_category = $(this).data('category-slug')
            console.log(updated_category)
            url.searchParams.set('category', updated_category)
            data=url.searchParams.set('page', 1)
			window.location.href = url.toString();

   	 })
    	$('.brand').click(function(){
        updated_brand = $(this).data('brand-slug')

        is_exist = brand_list.indexOf(updated_brand)
        console.log(is_exist)
        if(is_exist==-1){
            url.searchParams.append('brand', updated_brand)
        }
		data=url.searchParams.set('page', 1)
        window.location.href = url.toString();
    })
	$('.pages').click(function(){
		updated_page = $(this).data('page-number')
		data=url.searchParams.set('page', updated_page)
		console.log(data)
		window.location.href = url.toString();
	})

	$('.search').click(function(){
		search_data = $('#mySearch').val()
		// data=search_data.toUpperCase();
		// console.log(search_data)
		console.log(search_data)
		data=url.searchParams.set('q',search_data)
		data=url.searchParams.set('page', 1)
		window.location.href = url.toString();
	})

})	 

</script>
<script type="text/javascript">
	$(".addtocart").click(function () {
		qty=1
		product_id = $(this).data("productid");
		console.log(product_id)
		$.ajax({
		url: `{% url 'cart:addcart' '0' %}`.replace("0", product_id),
		type: "POST",
		data: { csrfmiddlewaretoken: "{{csrf_token}}",qty:qty },
		success: function (response) {
		  console.log(response);  
		},
	  });
	});
  </script>
  <script type="text/javascript">


	 
</script>

{% endblock javascript %}


